# 資安改進項目評估框架

**建立日期：** 2026-01-20  
**目的：** 提供系統化的評估方法，幫助判斷資安改進項目的優先級和必要性

---

## 🎯 評估方法概述

使用 **RISK × IMPACT × EFFORT** 評估模型，為每個改進項目計算優先級分數。

---

## 📊 評估維度說明

### 1. 風險評估 (RISK) - 1-5 分

**評估準則：**

| 分數 | 風險等級 | 說明 |
|------|---------|------|
| 5 | 極高 | 已知漏洞或攻擊向量，立即需要修復 |
| 4 | 高 | 存在明顯安全漏洞，可能被利用 |
| 3 | 中 | 潛在風險，需要關注 |
| 2 | 低 | 風險較小，但仍有改進空間 |
| 1 | 極低 | 風險極低，主要是最佳實踐 |

**評估因素：**
- 攻擊可能性（是否容易利用）
- 攻擊成本（攻擊者所需資源）
- 已知漏洞（是否有實際攻擊案例）
- 威脅情報（業界是否關注此問題）

### 2. 影響評估 (IMPACT) - 1-5 分

**評估準則：**

| 分數 | 影響等級 | 說明 |
|------|---------|------|
| 5 | 嚴重 | 可能導致資料外洩、服務中斷、法律責任 |
| 4 | 高 | 可能導致業務中斷、信譽損害 |
| 3 | 中 | 可能導致資料完整性問題、用戶體驗下降 |
| 2 | 低 | 影響較小，主要是便利性或效率問題 |
| 1 | 極低 | 幾乎無影響 |

**評估因素：**
- 資料敏感性（受影響的資料重要性）
- 業務影響（對核心業務的影響程度）
- 合規要求（是否符合法規要求）
- 用戶規模（受影響的用戶數量）

### 3. 實施難度 (EFFORT) - 1-5 分

**評估準則：**

| 分數 | 實施難度 | 說明 |
|------|---------|------|
| 1 | 極易 | 1-2 小時，無需外部依賴 |
| 2 | 容易 | 半天到 1 天，簡單配置 |
| 3 | 中等 | 2-5 天，需要一些開發工作 |
| 4 | 困難 | 1-2 週，需要重構或整合第三方服務 |
| 5 | 極難 | 1 個月以上，需要架構調整或大規模改動 |

**評估因素：**
- 開發時間（需要多少時間）
- 技術複雜度（技術難度如何）
- 資源需求（需要哪些資源）
- 依賴關係（是否需要其他改進先完成）
- 維護成本（實施後的持續維護成本）

### 4. 優先級分數計算

```
優先級分數 = (RISK × IMPACT) / EFFORT
```

**優先級等級：**

| 分數範圍 | 優先級 | 建議行動 |
|---------|--------|---------|
| ≥ 5.0 | 🔴 極高 | 立即實施 |
| 3.0 - 4.9 | 🟠 高 | 近期實施（1-2 週內） |
| 1.5 - 2.9 | 🟡 中 | 計劃實施（1 個月內） |
| 0.5 - 1.4 | 🟢 低 | 可選實施（3 個月內） |
| < 0.5 | ⚪ 極低 | 長期規劃或暫緩 |

---

## 📋 改進項目詳細評估

### 項目 1：API 路由身份驗證

#### 風險評估 (RISK)：**4/5** ⚠️

**評估理由：**
- ✅ 已知漏洞：`/api/google-sheets` 路由目前無身份驗證
- ✅ 容易利用：任何知道 URL 的人都可以呼叫
- ✅ 攻擊成本低：只需要 HTTP 請求即可
- ⚠️ 潛在影響：未授權用戶可能存取 Google Sheets 資料

**風險情境：**
1. 攻擊者發現 API 端點並大量呼叫
2. Google API 配額被消耗，導致正常用戶無法使用
3. 可能產生額外費用（如果超過免費配額）

#### 影響評估 (IMPACT)：**4/5** ⚠️

**評估理由：**
- ✅ 資料敏感性：Google Sheets 可能包含 QC 資料或其他敏感資訊
- ✅ 業務影響：API 配額被消耗可能影響系統正常運作
- ⚠️ 合規要求：需要控制資料存取權限
- ⚠️ 成本風險：可能導致 Google API 額外費用

#### 實施難度 (EFFORT)：**2/5** ✅

**評估理由：**
- ✅ 實施時間：約 1-2 小時
- ✅ 技術複雜度：簡單（使用 Supabase Auth 中間件）
- ✅ 無需重構：只需在 API Route 中添加驗證邏輯
- ✅ 無外部依賴：使用現有的 Supabase 認證系統

**實施步驟：**
1. 在 API Route 中添加 Supabase 會話驗證
2. 驗證失敗時返回 401 錯誤
3. 測試正常用戶和未授權用戶的存取

#### 優先級分數計算

```
優先級分數 = (RISK × IMPACT) / EFFORT
           = (4 × 4) / 2
           = 16 / 2
           = 8.0
```

**評估結果：** 🔴 **極高優先級（立即實施）**

---

### 項目 2：輸入驗證和清理

#### 風險評估 (RISK)：**3/5** ⚠️

**評估理由：**
- ⚠️ 潛在風險：可能存在 XSS 或注入攻擊風險
- ⚠️ React 保護：React 自動轉義大部分 XSS，但仍需驗證
- ⚠️ 資料完整性：無效資料可能導致系統錯誤
- ✅ 攻擊難度：需要一定的技術知識

**風險情境：**
1. 用戶輸入惡意腳本（雖然 React 會轉義）
2. 無效資料導致資料庫錯誤或系統崩潰
3. 特殊字符導致顯示問題

#### 影響評估 (IMPACT)：**3/5** ⚠️

**評估理由：**
- ⚠️ 資料完整性：可能導致資料損壞
- ⚠️ 用戶體驗：無效資料可能導致錯誤或異常
- ⚠️ 系統穩定性：極端輸入可能導致系統錯誤
- ⚠️ 合規要求：需要確保資料品質

#### 實施難度 (EFFORT)：**3/5** ⚠️

**評估理由：**
- ⚠️ 實施時間：約 3-5 天
- ⚠️ 技術複雜度：中等（需要整合驗證庫）
- ⚠️ 範圍廣泛：需要檢查所有輸入點
- ✅ 無需重構：可以逐步添加驗證

**實施步驟：**
1. 整合驗證庫（如 Zod 或 Yup）
2. 為所有表單添加驗證規則
3. 實施資料清理和正規化
4. 測試各種輸入情境

#### 優先級分數計算

```
優先級分數 = (RISK × IMPACT) / EFFORT
           = (3 × 3) / 3
           = 9 / 3
           = 3.0
```

**評估結果：** 🟠 **高優先級（近期實施）**

---

### 項目 3：API 速率限制

#### 風險評估 (RISK)：**4/5** ⚠️

**評估理由：**
- ✅ 已知風險：無速率限制可能遭受 DDoS 攻擊
- ✅ 容易利用：攻擊者可以輕鬆發送大量請求
- ✅ 攻擊成本低：只需要簡單的腳本
- ⚠️ 實際威脅：取決於系統公開程度

#### 影響評估 (IMPACT)：**3/5** ⚠️

**評估理由：**
- ✅ 服務可用性：防止服務被癱瘓
- ✅ 成本控制：防止 API 配額被消耗
- ⚠️ 業務影響：主要是預防性措施
- ⚠️ 當前無實際攻擊：但潛在影響大

#### 實施難度 (EFFORT)：**2/5** ✅

**評估理由：**
- ✅ 實施時間：約半天到 1 天
- ✅ 技術複雜度：簡單（使用 Next.js Middleware）
- ✅ 無需重構：只需添加中間件
- ✅ Vercel 支援：Vercel 有內建速率限制功能

#### 優先級分數計算

```
優先級分數 = (RISK × IMPACT) / EFFORT
           = (4 × 3) / 2
           = 12 / 2
           = 6.0
```

**評估結果：** 🔴 **極高優先級（立即實施）**

---

### 項目 4：Content Security Policy (CSP)

#### 風險評估 (RISK)：**2/5** ✅

**評估理由：**
- ⚠️ 防護措施：主要是深度防禦（Defense in Depth）
- ✅ React 保護：React 已經提供基本的 XSS 保護
- ⚠️ 實際威脅：如果 React 有漏洞，CSP 可以提供額外保護
- ⚠️ 攻擊難度：需要特定的攻擊情境

#### 影響評估 (IMPACT)：**2/5** ✅

**評估理由：**
- ⚠️ 額外防護：增加一層安全防護
- ⚠️ 合規要求：某些標準建議使用 CSP
- ✅ 當前無實際威脅：主要是預防性措施

#### 實施難度 (EFFORT)：**2/5** ✅

**評估理由：**
- ✅ 實施時間：約 2-4 小時
- ✅ 技術複雜度：簡單（配置 CSP 標頭）
- ⚠️ 測試需求：需要測試所有功能確保 CSP 不會阻擋正常操作
- ⚠️ 維護成本：可能需要調整 CSP 規則

#### 優先級分數計算

```
優先級分數 = (RISK × IMPACT) / EFFORT
           = (2 × 2) / 2
           = 4 / 2
           = 2.0
```

**評估結果：** 🟡 **中優先級（計劃實施）**

---

### 項目 5：錯誤追蹤系統（Sentry）

#### 風險評估 (RISK)：**2/5** ✅

**評估理由：**
- ⚠️ 監控工具：主要是用於發現問題，不是防護措施
- ✅ 實際威脅：無直接安全威脅
- ⚠️ 間接安全：可以幫助發現安全問題

#### 影響評估 (IMPACT)：**3/5** ⚠️

**評估理由：**
- ✅ 問題發現：可以及時發現安全漏洞
- ✅ 業務影響：提高系統穩定性和可維護性
- ⚠️ 合規要求：需要日誌記錄（但可以使用其他方式）

#### 實施難度 (EFFORT)：**2/5** ✅

**評估理由：**
- ✅ 實施時間：約半天到 1 天
- ✅ 技術複雜度：簡單（整合 Sentry SDK）
- ⚠️ 配置需求：需要配置 Sentry 專案和告警規則
- ⚠️ 維護成本：需要定期查看錯誤報告

#### 優先級分數計算

```
優先級分數 = (RISK × IMPACT) / EFFORT
           = (2 × 3) / 2
           = 6 / 2
           = 3.0
```

**評估結果：** 🟠 **高優先級（近期實施）**

---

### 項目 6：監控和日誌系統

#### 風險評估 (RISK)：**2/5** ✅

**評估理由：**
- ⚠️ 監控工具：主要是用於發現問題
- ⚠️ 間接安全：可以幫助發現異常行為
- ✅ 實際威脅：無直接安全威脅

#### 影響評估 (IMPACT)：**3/5** ⚠️

**評估理由：**
- ✅ 安全審計：需要記錄安全相關事件
- ✅ 合規要求：某些標準要求日誌記錄
- ⚠️ 業務影響：主要是監控和合規需求

#### 實施難度 (EFFORT)：**3/5** ⚠️

**評估理由：**
- ⚠️ 實施時間：約 3-5 天
- ⚠️ 技術複雜度：中等（需要設計日誌格式和儲存方案）
- ⚠️ 資源需求：可能需要額外的儲存空間
- ⚠️ 維護成本：需要定期檢視和分析日誌

#### 優先級分數計算

```
優先級分數 = (RISK × IMPACT) / EFFORT
           = (2 × 3) / 3
           = 6 / 3
           = 2.0
```

**評估結果：** 🟡 **中優先級（計劃實施）**

---

### 項目 7：雙因素認證 (2FA)

#### 風險評估 (RISK)：**2/5** ✅

**評估理由：**
- ⚠️ 增強安全性：可以提高帳號安全
- ⚠️ 當前無實際威脅：密碼認證目前足夠
- ✅ 攻擊難度：帳號盜用風險較低（使用 Supabase Auth）

#### 影響評估 (IMPACT)：**2/5** ✅

**評估理由：**
- ⚠️ 用戶體驗：可能增加使用複雜度
- ⚠️ 業務影響：不是必須功能
- ✅ 當前無實際需求：無高價值帳號需要額外保護

#### 實施難度 (EFFORT)：**4/5** ⚠️

**評估理由：**
- ⚠️ 實施時間：約 1-2 週
- ⚠️ 技術複雜度：困難（需要整合 TOTP 或 SMS）
- ⚠️ 用戶體驗：需要設計清晰的 UI/UX
- ⚠️ 維護成本：需要處理用戶忘記 2FA 的情況

#### 優先級分數計算

```
優先級分數 = (RISK × IMPACT) / EFFORT
           = (2 × 2) / 4
           = 4 / 4
           = 1.0
```

**評估結果：** 🟢 **低優先級（可選實施）**

---

### 項目 8：資料加密 (Encryption at Rest)

#### 風險評估 (RISK)：**1/5** ✅

**評估理由：**
- ✅ 資料敏感性：排程資料敏感性中等
- ✅ Supabase 保護：Supabase 已有基本的資料保護
- ⚠️ 實際威脅：資料庫被直接存取的可能性極低

#### 影響評估 (IMPACT)：**2/5** ✅

**評估理由：**
- ⚠️ 合規要求：某些標準要求資料加密
- ⚠️ 資料敏感性：排程資料不是高度敏感資料
- ✅ 當前無實際需求：Supabase 已有基本保護

#### 實施難度 (EFFORT)：**5/5** ⚠️

**評估理由：**
- ⚠️ 實施時間：約 1 個月以上
- ⚠️ 技術複雜度：極難（需要架構調整）
- ⚠️ 資源需求：需要額外的加密金鑰管理
- ⚠️ 維護成本：高（金鑰輪換、效能影響）

#### 優先級分數計算

```
優先級分數 = (RISK × IMPACT) / EFFORT
           = (1 × 2) / 5
           = 2 / 5
           = 0.4
```

**評估結果：** ⚪ **極低優先級（長期規劃或暫緩）**

---

## 📊 評估結果總表

| 項目 | RISK | IMPACT | EFFORT | 優先級分數 | 優先級 | 建議 |
|------|------|--------|--------|-----------|--------|------|
| **API 身份驗證** | 4 | 4 | 2 | **8.0** | 🔴 極高 | 立即實施 |
| **API 速率限制** | 4 | 3 | 2 | **6.0** | 🔴 極高 | 立即實施 |
| **錯誤追蹤系統** | 2 | 3 | 2 | **3.0** | 🟠 高 | 近期實施 |
| **輸入驗證清理** | 3 | 3 | 3 | **3.0** | 🟠 高 | 近期實施 |
| **CSP** | 2 | 2 | 2 | **2.0** | 🟡 中 | 計劃實施 |
| **監控日誌** | 2 | 3 | 3 | **2.0** | 🟡 中 | 計劃實施 |
| **2FA** | 2 | 2 | 4 | **1.0** | 🟢 低 | 可選實施 |
| **資料加密** | 1 | 2 | 5 | **0.4** | ⚪ 極低 | 長期規劃 |

---

## 🎯 決策建議

### 立即實施（本週內）

1. **API 身份驗證** (8.0 分)
   - ✅ 高風險、高影響、低實施難度
   - ✅ 可以立即修復安全漏洞
   - ✅ 實施時間：1-2 小時

2. **API 速率限制** (6.0 分)
   - ✅ 高風險、中等影響、低實施難度
   - ✅ 防止 DDoS 和資源濫用
   - ✅ 實施時間：半天到 1 天

### 近期實施（2-4 週內）

3. **錯誤追蹤系統** (3.0 分)
   - ✅ 可以幫助發現安全問題
   - ✅ 提高系統可維護性
   - ✅ 實施時間：半天到 1 天

4. **輸入驗證清理** (3.0 分)
   - ✅ 提高資料品質和系統穩定性
   - ⚠️ 需要較多時間進行全面檢查
   - ⚠️ 實施時間：3-5 天

### 計劃實施（1-3 個月內）

5. **CSP** (2.0 分)
   - ⚠️ 額外的安全防護層
   - ⚠️ 需要測試確保不影響功能

6. **監控日誌** (2.0 分)
   - ⚠️ 合規和審計需求
   - ⚠️ 需要設計日誌架構

### 長期規劃（6 個月以上）

7. **2FA** (1.0 分)
   - ⚠️ 增強安全性，但當前非必須
   - ⚠️ 需要用戶接受度評估

8. **資料加密** (0.4 分)
   - ⚠️ 成本效益比低
   - ⚠️ 當前無實際需求

---

## 💡 評估考量因素

### 1. 業務需求

**問題：**
- 系統是否處理高度敏感資料？
- 是否有合規要求？
- 業務規模和用戶數量？

**建議：**
- 如果處理高度敏感資料，提高所有項目的 IMPACT 分數
- 如果有合規要求，相應項目的 IMPACT 需要提高
- 如果用戶規模大，提高速率限制的優先級

### 2. 資源限制

**問題：**
- 開發團隊規模？
- 可用時間？
- 預算限制？

**建議：**
- 優先實施分數高且 EFFORT 低的項目
- 可以分階段實施，先做最關鍵的
- 考慮外包或使用現成服務（如 Sentry）

### 3. 實際威脅

**問題：**
- 系統是否公開？
- 是否已知有攻擊嘗試？
- 是否有敏感資料外洩風險？

**建議：**
- 如果系統公開，提高速率限制和身份驗證的優先級
- 如果有實際攻擊，相關項目的 RISK 需要提高
- 定期重新評估威脅等級

### 4. 成本效益

**問題：**
- 實施成本 vs 預期收益？
- 維護成本是否可接受？
- 用戶體驗影響？

**建議：**
- 優先實施成本低、收益高的項目
- 評估長期維護成本
- 考慮用戶體驗影響

---

## 🔄 持續評估

### 評估週期

**建議：**
- **每月評估：** 重新計算優先級分數
- **重大事件後：** 發生安全事件後立即重新評估
- **系統變更後：** 添加新功能或改變架構後重新評估

### 評估指標

**追蹤：**
- 安全事件數量
- 漏洞發現和修復時間
- 合規檢查結果
- 用戶反饋

### 動態調整

**調整時機：**
- 發現新的威脅或漏洞
- 業務需求改變
- 技術環境變化
- 合規要求更新

---

## ✅ 結論

使用 **RISK × IMPACT / EFFORT** 評估模型，可以科學地判斷改進項目的優先級。

**建議行動：**

1. **立即實施（本週）：**
   - API 身份驗證
   - API 速率限制

2. **近期實施（2-4 週）：**
   - 錯誤追蹤系統
   - 輸入驗證清理

3. **計劃實施（1-3 個月）：**
   - CSP
   - 監控日誌

4. **長期規劃（6 個月以上）：**
   - 2FA（如有需要）
   - 資料加密（如合規要求）

**記住：**
- 評估不是一次性的，需要持續進行
- 根據實際情況動態調整優先級
- 優先實施風險高、影響大、實施容易的項目

---

**文檔建立者：** AI Assistant  
**下次評估日期：** 建議每月重新評估
